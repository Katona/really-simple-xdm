<html>
<body>
  <iframe id="testFrame" src="./iframe.html"></iframe>
  <div>Message from received from iframe: </div><span id="response_from_iframe"></span>
  <script src="/index.js"></script>
  <script>
    const iframeElement = document.getElementById('testFrame');
    const messagingSrv = new xdmjs.CrossWindowMessagingService(iframeElement.contentWindow, "*");
    messagingSrv.onMessage(msg => {
      if (msg.type !== "test") {
        return;
      }
      document.querySelector("#response_from_iframe").innerHTML = msg.payload;
      console.log("Message received from iframe: ", msg.payload);
      messagingSrv.sendMessage({ type: "test", payload: "Parent message" });
    });
  </script>
</body>
</html>